<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Trip to Tokyo 2026</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'snow-white': '#F0FFFF',        // 雪白色/極淺藍
                        'ice-blue': '#B3E5FC',          // 冰川藍
                        'light-snow-blue': '#E5F3F7',   // 整個頁面柔和淺藍底色
                        'deep-sea-blue': '#01579B',     // 深海藍 (文字/強調)
                        'accent-yellow': '#FFD54F',     // 溫暖黃 (按鈕/點綴)
                        'soft-gray': '#F5F5F5'          // 背景灰
                    }
                }
            }
        }
    </script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&display=swap');
        body {
            background-color: #E5F3F7; 
            -webkit-tap-highlight-color: transparent;
            font-family: 'Noto Sans TC', sans-serif;
            color: #334155;
        }

        .app-container {
            max-width: 480px;
            margin: 0 auto;
            min-height: 100vh;
            background-color: #ffffff; 
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.05);
            position: relative;
            padding-bottom: 90px;
        }

        /* ****** 修正 1: 確保頁首背景為白色，完全消除多餘的藍色區塊 ****** */
        .header-bg {
            /* 關鍵修正: 設置為白色以確保沒有藍色殘留 */
            background-color: #ffffff; 
            padding: 0; 
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15); 
            /* --- 圓弧銜接 --- */
            border-bottom-left-radius: 35px; 
            border-bottom-right-radius: 35px;
            z-index: 10; 
            padding-bottom: 0px; 
        }
        
        /* 圖片專用容器 */
        .header-image-container {
            width: 100%;
            height: 250px; 
            overflow: hidden;
            background-color: transparent; 
            border-bottom-left-radius: 35px; 
            border-bottom-right-radius: 35px;
        }
        
        .header-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover; 
            display: block; 
        }
        
        /* 雪花圖層 (保持透明度，讓圖片更柔和) */
        .snow-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* 背景圖案只有白色雪花點 */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><circle cx="50" cy="50" r="1" fill="%23fff" opacity="0.8"/><circle cx="20" cy="80" r="0.5" fill="%23fff" opacity="0.6"/><circle cx="70" cy="30" r="1.5" fill="%23fff" opacity="0.9"/></svg>');
            background-size: 100px 100px;
            opacity: 0.7;
            animation: snowfall 10s linear infinite;
            z-index: 5;
        }

        @keyframes snowfall {
            to {
                background-position: 100px 100px;
            }
        }
        
        /* ****** 修正 2: Tab 按鈕容器樣式 (向上大移動) ****** */
        .side-tab-bar {
            position: absolute;
            /* 關鍵調整: 將底邊距向上拉至 45px，確保按鈕完全位於圖片區內 */
            bottom: 45px; 
            right: 16px;
            z-index: 30; /* 確保它在最上層 */
            
            /* 橫向排列 */
            display: flex;
            flex-direction: row;
            gap: 8px; 
        }
        
        /* 單一按鈕樣式 */
        .tab-button {
            width: 40px; 
            height: 40px;
            border-radius: 9999px; 
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.125rem; 
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); 
            transition: all 0.2s ease;
        }
        
        /* 活躍按鈕樣式 */
        .tab-button.active {
            background-color: #01579B; /* deep-sea-blue */
            color: #ffffff;
            box-shadow: 0 6px 15px rgba(1, 87, 155, 0.4); 
            transform: scale(1.05);
        }
        
        /* 非活躍按鈕樣式 */
        .tab-button:not(.active) {
            background-color: #ffffff;
            color: #B3E5FC; /* ice-blue */
        }


        /* --- 圓弧銜接的主內容區域 --- */
        .app-main {
            padding-top: 25px !important; 
            position: relative;
            z-index: 5;
        }
        
        /* 隱藏捲軸但保持滑動功能 */
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none; 
        }

        /* 卡片柔和陰影 */
        .card-shadow {
            box-shadow: 0 4px 20px rgba(179, 229, 252, 0.3);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        /* 頁面淡入動畫 */
        .animate-fade-in {
            animation: fadeIn 0.4s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 自定義浮動按鈕陰影 */
        .fab-shadow {
            box-shadow: 0 4px 15px rgba(255, 213, 79, 0.5);
        }

        /* 備註內容高度控制 */
        .note-content {
            max-height: 2.5rem;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }

        .note-content.expanded {
            max-height: 500px;
        }
        
        /* 支出圓形分類標籤 */
        .expense-category-tag {
            min-width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* 花費頁 Banner 顏色調整 */
        .expenses-banner {
            background: linear-gradient(135deg, #01579B 0%, #0097A7 100%);
        }
        
        /* 日期選單置頂的背景 */
        .date-selector-sticky {
             /* 讓日期選單置頂在 Banner 下方，並給予白色背景 */
            background-color: #ffffff;
            border-bottom: 1px solid #f0f0f0; 
            z-index: 20; 
            top: 0; 
        }
    </style>
</head>
<body>

<div id="app" class="app-container">

    <div class="header-bg relative">
        <div class="header-image-container">
            <img src="IMG_4330.jpg" alt="東京公仔之旅">
        </div>
        
        <div class="snow-layer"></div> 
        
        <div class="side-tab-bar">
            <button @click="currentTab = 'itinerary'" title="行程" 
                    :class="{'active': currentTab === 'itinerary'}" 
                    class="tab-button">
                <i class="fa-solid fa-map-location-dot"></i>
            </button>
            
            <button @click="currentTab = 'info'" title="資訊" 
                    :class="{'active': currentTab === 'info'}" 
                    class="tab-button">
                <i class="fa-solid fa-circle-info"></i>
            </button>
            
            <button @click="currentTab = 'shopping'" title="購物" 
                    :class="{'active': currentTab === 'shopping'}" 
                    class="tab-button">
                <i class="fa-solid fa-basket-shopping"></i>
            </button>
            
            <button @click="currentTab = 'expenses'" title="花費" 
                    :class="{'active': currentTab === 'expenses'}" 
                    class="tab-button">
                <i class="fa-solid fa-coins"></i>
            </button>
        </div>
        </div>

    
    <main class="p-4 app-main">
        
        <div v-if="currentTab === 'itinerary'" class="animate-fade-in">
            
            <div class="flex overflow-x-auto hide-scrollbar space-x-3 pb-4 mb-2 snap-x px-1 sticky date-selector-sticky pt-1 -mx-4 px-4">
                <div v-for="(day, index) in dates" :key="index" 
                     @click="selectedDateIndex = index"
                     class="snap-center flex-shrink-0 w-[58px] h-[68px] rounded-xl flex flex-col items-center justify-center cursor-pointer transition-all duration-300 border-2 shadow-sm"
                     :class="selectedDateIndex === index ?
'bg-deep-sea-blue text-white border-deep-sea-blue shadow-lg scale-105' : 'bg-white text-slate-400 border-white hover:bg-soft-gray'">
                    
                    <span class="text-sm font-bold uppercase tracking-wider">{{ day.weekday }}</span> 
                    <span class="text-xs font-medium opacity-70">{{ day.date }}</span> 
                </div>
            </div>

            <div v-if="weatherData[selectedDateIndex]" class="mb-4 bg-snow-white border border-ice-blue rounded-2xl p-4 flex justify-between items-center shadow-md">
                <div class="flex items-start text-deep-sea-blue space-x-4">
                    <i :class="getWeatherIcon(weatherData[selectedDateIndex].condition)" class="text-5xl text-blue-500"></i>
                    
                    <div class="pt-1">
                        <span class="text-3xl font-extrabold leading-none">{{ weatherData[selectedDateIndex].temp.split('/')[0] }}°</span>
                        <span class="text-sm font-light text-slate-500 ml-1">/ {{ weatherData[selectedDateIndex].temp.split('/')[1] }}°C</span>
                        <span class="block text-xs text-slate-600 mt-1">體感: {{ weatherData[selectedDateIndex].feel }}°C</span> 
                    </div>
                </div>
                <div class="text-right text-xs text-slate-600 pl-3">
                    <span class="font-bold block text-slate-700">{{ getWeatherDescription(weatherData[selectedDateIndex].condition) }}</span>
                    
                    <span v-if="dates[selectedDateIndex].hasCar" class="mt-1 block text-deep-sea-blue font-bold">
                        <i class="fa-solid fa-car-side mr-1 text-accent-yellow"></i> 租車日
                        <span v-if="dates[selectedDateIndex].tollFee" class="ml-2 bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded-full">
                            ¥{{ formatNumber(dates[selectedDateIndex].tollFee) }}
                        </span>
                    </span>
                    <span v-else class="mt-1 block text-slate-400">本日步行/大眾運輸</span>
                </div>
            </div>

            <div class="space-y-4">
                <div v-for="(item, idx) in currentItinerary" :key="item.id" class="relative group">
                    
                    <div v-if="idx > 
0" class="pl-8 pb-2 flex items-center text-xs text-slate-400">
                        <div class="h-6 w-0.5 bg-slate-200 absolute left-6 -top-3"></div>
                        
                        <i :class="getTransportIcon(currentItinerary[idx].transportType)" 
                            class="mr-2 text-slate-300 cursor-pointer hover:text-deep-sea-blue transition-colors" 
                           @click="openMapDirections(currentItinerary[idx - 1], item)">
                        </i>
                        <span class="font-bold">{{ item.travelTime ||
'約 15 分鐘' }}</span>
                    </div>
                    
                    <div class="bg-white rounded-3xl p-5 card-shadow relative overflow-hidden flex items-start border border-ice-blue/50">
                        
                        <div class="mr-4 flex flex-col items-center min-w-[50px]">
                            <div class="p-2 rounded-full text-white shadow-md text-base mb-1" :class="getCategoryColor(item.category)">
                                <i :class="getCategoryIcon(item.category)"></i>
                            </div>
                            <span v-if="item.startTime" class="text-xs font-bold text-slate-600 mt-1">{{ item.startTime }}</span>
                        </div>

                        <div class="flex-1 pb-1">
                            <h3 class="text-lg font-bold text-slate-800 mb-1 leading-tight pr-8">{{ item.name }}</h3>
                            
                            <div 
class="text-sm text-slate-500 space-y-1.5 mt-2">
                                <p v-if="item.hours" class="flex items-center"><i class="fa-regular fa-clock w-4 text-center mr-2 text-ice-blue"></i> 營業: {{ item.hours }}</p>
                                <p v-if="item.price" class="flex items-center"><i class="fa-solid fa-ticket w-4 text-center mr-2 text-ice-blue"></i> 門票/費用: {{ item.price }}</p>
                                <p v-if="item.address" class="flex items-start"><i class="fa-solid fa-location-dot w-4 text-center mr-2 mt-1 text-ice-blue"></i> {{ item.address }}</p>
                            </div>

                            <div v-if="item.note && item.note.length > 0" 
class="mt-3 text-xs bg-slate-50 p-2.5 rounded-lg border border-slate-100">
                                <p class="text-slate-600 font-bold mb-1 flex items-center">
                                    <i class="fa-solid fa-highlighter text-accent-yellow mr-2"></i> 備註
                                </p>
                                <div class="note-content" :class="{'expanded': item.isNoteExpanded}">
                                    {{ item.note }}
                                </div>
                                <button v-if="item.note.length > 50" @click="item.isNoteExpanded = !item.isNoteExpanded" class="text-deep-sea-blue font-bold mt-1 block">
                                    {{ 
item.isNoteExpanded ? '收合備註' : '查看更多...' }}
                                </button>
                            </div>
                        </div>

                        <div class="absolute top-3 right-3 flex flex-col space-y-1">
                            <button v-if="idx > 0" @click.stop="moveItineraryUp(item.id)" class="w-7 h-7 bg-slate-100 text-slate-500 rounded-full flex items-center justify-center text-xs hover:bg-slate-300 transition-colors" title="上移">
                                <i class="fa-solid fa-arrow-up"></i>
                            </button>
                            <button v-if="idx < currentItinerary.length - 1" @click.stop="moveItineraryDown(item.id)" class="w-7 h-7 bg-slate-100 text-slate-500 rounded-full flex items-center justify-center text-xs hover:bg-slate-300 transition-colors" title="下移">
                                <i class="fa-solid fa-arrow-down"></i>
                            </button>
                            <button @click.stop="openMap(item.address || item.name)" class="w-7 h-7 bg-ice-blue text-deep-sea-blue rounded-full flex items-center justify-center text-xs hover:bg-deep-sea-blue hover:text-white transition-colors" title="Google Maps 導航">
                                <i class="fa-solid fa-location-arrow"></i>
                            </button>
                            <button @click.stop="editItem(item)" class="w-7 h-7 bg-slate-100 text-slate-500 rounded-full flex items-center justify-center text-xs hover:bg-slate-200 transition-colors" title="編輯行程">
                                <i class="fa-solid fa-pencil"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <div v-if="currentItinerary.length === 0" class="text-center py-16 text-slate-300">
                    <i class="fa-solid fa-map-location-dot text-5xl mb-3 text-slate-200"></i>
                    <p class="text-sm">本日尚無行程<br>請點擊右下角新增</p>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'info'" class="space-y-5 animate-fade-in">
            
            <div class="bg-gradient-to-r from-deep-sea-blue to-cyan-700 rounded-3xl p-6 text-white shadow-xl relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-10 -mt-10 blur-2xl"></div>
                <div class="absolute bottom-0 left-0 w-32 h-32 
bg-white/10 rounded-full -ml-10 -mb-10 blur-2xl"></div>
                <h3 class="font-bold text-lg mb-4 flex items-center relative z-10"><i class="fa-solid fa-calculator mr-2"></i> 匯率換算</h3>
                <div class="flex items-center justify-between space-x-3 relative z-10">
                    <div class="flex-1">
                        <label class="text-[10px] 
text-cyan-200 block mb-1 uppercase tracking-wider">JPY (日幣)</label>
                        <input type="number" v-model="currencyInput" @input="calculateCurrency" class="w-full bg-white/20 border border-white/30 rounded-xl px-3 py-2.5 text-white placeholder-white/50 focus:outline-none focus:bg-white/30 text-lg font-bold" placeholder="¥">
                    </div>
                    <i class="fa-solid fa-arrow-right-arrow-left text-cyan-300 mt-5"></i>
                    <div class="flex-1">
                        <label class="text-[10px] text-cyan-200 block mb-1 uppercase tracking-wider">TWD (台幣)</label>
                        <div class="w-full bg-white/10 rounded-xl px-3 py-2.5 text-white text-lg font-bold border border-transparent">
                            $ {{ currencyResult }}
                        </div>
                    </div>
                </div>
                <p class="text-[10px] text-cyan-300 mt-3 text-right relative z-10">匯率基準: 0.205</p>
            </div>
            
            <div class="bg-white rounded-3xl p-5 card-shadow">
                <h3 class="font-bold text-slate-800 mb-3 border-b border-slate-100 pb-2"><i class="fa-solid fa-plane-departure text-blue-500 mr-2"></i> 航班資訊</h3>
                <div class="space-y-4">
                    <div class="bg-blue-50 rounded-xl p-3 border border-blue-100">
                        <div class="flex justify-between text-sm font-bold text-deep-sea-blue mb-1">
                            <span>TPE 台北</span>
                            <i class="fa-solid fa-plane text-xs"></i>
                            <span>NRT 成田</span>
                        </div>
                        <div class="flex justify-between text-xs text-slate-500">
                            <span>12:35</span>
                            <span>CI104 (2/5)</span>
                            <span>16:35</span>
                        </div>
                    </div>
                    <div class="bg-orange-50 rounded-xl p-3 border border-orange-100">
                        <div class="flex justify-between text-sm font-bold text-orange-800 mb-1">
                            <span>NRT 成田</span>
                            <i class="fa-solid fa-plane text-xs"></i>
                            <span>TPE 台北</span>
                        </div>
                        <div class="flex justify-between text-xs text-slate-500">
                            <span>19:30</span>
                            <span>CI109 (2/12)</span>
                            <span>22:45</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-3xl p-6 card-shadow">
                <h3 class="font-bold text-slate-800 mb-4 border-b border-slate-100 pb-3"><i class="fa-solid fa-hotel text-indigo-500 mr-2"></i> 住宿資訊</h3>
                <ul class="space-y-5">
                    <li v-for="hotel in hotels" class="border-b last:border-0 pb-4 last:pb-0">
                        <div class="flex justify-between items-start group">
                            <div class="flex-1">
                                <span class="font-bold block text-slate-700 text-lg">{{ hotel.name }}</span>
                                <span class="text-xs text-slate-400 bg-slate-100 px-2 py-0.5 rounded-full inline-block mt-1">{{ hotel.date }}</span>
                            </div>
                            <button @click="openMap(hotel.name)" class="w-8 h-8 rounded-full bg-indigo-50 text-indigo-500 flex items-center justify-center group-hover:bg-indigo-500 group-hover:text-white transition-all"><i class="fa-solid fa-location-arrow text-xs"></i></button>
                        </div>
                        <div class="text-sm text-slate-500 mt-2 space-y-1">
                            <p class="flex items-center"><i class="fa-solid fa-phone w-4 text-center mr-2 text-slate-300"></i> <a :href="'tel:' + hotel.phone" class="hover:text-deep-sea-blue">+81361612288</a></p>
                            <p class="flex items-start"><i class="fa-solid fa-map-pin w-4 text-center mr-2 mt-1 text-slate-300"></i> 2 Chome-4-1 Higashiueno, Taito City, Tokyo 110-0015日本</p>
                        </div>
                    </li>
                </ul>
            </div>

            
            <div class="bg-red-50 rounded-3xl p-6 border border-red-100">
                <h3 class="font-bold text-red-800 mb-4"><i class="fa-solid fa-kit-medical mr-2"></i> 緊急聯絡</h3>
                <div class="grid grid-cols-2 gap-4 text-center">
                    <a href="tel:110" class="bg-white py-3 rounded-xl shadow-sm text-red-600 font-bold block border border-red-100 hover:bg-red-600 hover:text-white transition-all">
                        <i class="fa-solid fa-user-shield mr-1"></i> 警察 110
                    </a>
                    <a href="tel:119" class="bg-white py-3 rounded-xl shadow-sm text-red-600 font-bold block border border-red-100 hover:bg-red-600 
hover:text-white transition-all">
                        <i class="fa-solid fa-truck-medical mr-1"></i> 救護 119
                    </a>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'shopping'" class="animate-fade-in">
            <div class="grid grid-cols-2 gap-4">
                <div v-for="(item, idx) in shoppingList" :key="idx" class="bg-white rounded-2xl p-3 card-shadow relative group">
                    <div class="aspect-square bg-slate-50 rounded-xl mb-3 overflow-hidden relative border border-slate-100">
                        <img v-if="item.image" :src="item.image" class="w-full h-full object-cover">
                        <div v-else class="w-full h-full flex items-center justify-center text-slate-300">
                            <i class="fa-solid fa-bag-shopping text-3xl"></i>
                        </div>
                        <button @click="removeShoppingItem(idx)" class="absolute top-2 right-2 bg-black/60 text-white rounded-full w-7 h-7 flex items-center justify-center text-xs opacity-0 group-hover:opacity-100 transition-opacity">
                            <i class="fa-solid fa-xmark"></i>
                        </button>
                    </div>
                    <p class="font-bold text-sm text-slate-800 truncate px-1">{{ item.name }}</p>
                </div>
                
                <div v-if="shoppingList.length % 2 !== 0" class="h-0 invisible"></div>
                
                <div v-if="shoppingList.length === 0" class="col-span-2 text-center py-16 text-slate-300">
                    <i class="fa-solid fa-bag-shopping text-5xl mb-3 text-slate-200"></i>
                    <p class="text-sm">購物清單空白<br>請點擊右下角新增</p>
                </div>
            </div>
        </div>

        <div v-if="currentTab === 'expenses'" class="animate-fade-in">
            <div class="expenses-banner text-white rounded-3xl p-8 mb-6 relative overflow-hidden">
               
                <div class="absolute -right-10 -top-10 bg-white/10 w-48 h-48 rounded-full blur-3xl"></div>
                <div class="absolute -left-10 -bottom-10 bg-ice-blue/20 w-40 h-40 rounded-full blur-2xl"></div>
                <p class="text-sm text-cyan-200 mb-2 relative z-10">目前總花費 (JPY)</p>
                <h2 class="text-5xl font-bold relative z-10 tracking-tight">¥ {{ formatNumber(totalExpensesJPY) }}</h2>
                <p class="text-sm text-right mt-2 opacity-80 
relative z-10">約 NT$ {{ formatNumber(totalExpensesTWD) }}</p>
            </div>

            <div class="bg-white rounded-t-3xl min-h-[500px] p-6 shadow-[0_-10px_40px_rgba(0,0,0,0.03)] -mx-4 px-8">
                <h3 class="font-bold text-slate-800 mb-5 flex items-center">
                    <i class="fa-solid fa-receipt text-slate-300 mr-2"></i>支出紀錄
                </h3>
                <div class="space-y-5">
                    <div v-for="(exp, idx) in expenses" :key="idx" class="flex items-center justify-between border-b border-slate-50 pb-4 last:border-0">
                        <div class="flex items-center">
                            
                            <div class="expense-category-tag mr-4" :class="[getCategoryColor(exp.category), 'text-white']">
                                {{ getCategoryLabel(exp.category) }}
                            </div>
                            <div>
                                <p class="font-bold text-slate-700 text-sm mb-0.5">{{ exp.name }}</p>
                                <p class="text-[10px] text-slate-400 uppercase tracking-wide">{{ exp.date }} · {{ exp.payment === 'card' ?
'信用卡' : '現金' }}</p>
                            </div>
                        </div>
                        <div class="text-right flex items-center">
                            <p class="font-bold text-slate-700">¥{{ formatNumber(exp.amount) }}</p>
                            <button @click="removeExpense(idx)" class="w-5 h-5 ml-3 text-red-300 hover:text-red-500 transition-colors flex items-center justify-center">
                                <i class="fa-solid fa-xmark text-lg"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </main>

 
    <button v-if="currentTab !== 'info'" @click="handleAddClick" class="fixed bottom-6 right-6 w-14 h-14 bg-accent-yellow rounded-full fab-shadow text-deep-sea-blue text-2xl flex items-center justify-center hover:scale-110 transition-transform z-40">
        <i class="fa-solid fa-plus"></i>
    </button>

    <div v-if="showShoppingModal" class="fixed inset-0 bg-deep-sea-blue/40 z-50 flex items-center justify-center p-6 backdrop-blur-sm animate-fade-in">
        <div class="bg-white rounded-3xl w-full max-w-sm p-6 shadow-2xl">
            <h3 class="font-bold text-lg mb-5 text-center text-slate-800">新增購物清單</h3>
            <input v-model="newShoppingItem.name" type="text" placeholder="商品名稱" class="w-full 
bg-slate-50 border-none rounded-xl p-4 mb-4 focus:ring-2 focus:ring-deep-sea-blue text-sm">
            <div class="relative mb-6">
                <input type="file" @change="handleImageUpload" class="hidden" id="fileInput">
                <label for="fileInput" class="w-full h-36 bg-slate-50 border-2 border-dashed border-slate-200 rounded-xl flex items-center justify-center cursor-pointer text-slate-400 hover:bg-slate-100 hover:border-border-slate-300 transition-all">
                    <span v-if="!newShoppingItem.image" class="flex flex-col items-center text-xs">
                        <i class="fa-solid fa-camera text-2xl mb-2"></i> 上傳照片
                    </span>
                    <img v-else :src="newShoppingItem.image" class="h-full w-full object-contain rounded-xl">
                </label>
           
            </div>
            <div class="flex space-x-3">
                <button @click="showShoppingModal = false" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-500 font-bold text-sm">取消</button>
                <button @click="addShoppingItem" class="flex-1 py-3 rounded-xl bg-deep-sea-blue text-white font-bold text-sm shadow-lg shadow-deep-sea-blue/30">新增</button>
            </div>
        </div>
    </div>
    
    <div 
v-if="showExpenseModal" class="fixed inset-0 bg-deep-sea-blue/40 z-50 flex items-center justify-center p-6 backdrop-blur-sm animate-fade-in">
        <div class="bg-white rounded-3xl w-full max-w-sm p-6 shadow-2xl">
            <h3 class="font-bold text-lg mb-5 text-center text-slate-800">記一筆</h3>
            <div class="grid grid-cols-2 gap-3 mb-4">
                <input v-model="newExpense.date" type="date" class="bg-slate-50 rounded-xl p-3 text-sm text-slate-600 outline-none">
                <select v-model="newExpense.category" class="bg-slate-50 
rounded-xl p-3 text-sm text-slate-600 outline-none">
                    <option value="food">飲食</option>
                    <option value="shopping">購物</option>
                    <option value="transport">交通</option>
                    <option value="stay">住宿</option>
            
                    <option value="ticket">門票</option>
                    <option value="other">其他</option>
                </select>
            </div>
            <input v-model="newExpense.name" placeholder="名稱 (如: 湯咖哩)" class="w-full bg-slate-50 rounded-xl p-4 mb-4 text-sm outline-none focus:ring-2 focus:ring-accent-yellow">
            <div class="relative mb-4">
   
                <span class="absolute left-4 top-4 text-slate-400 font-bold">¥</span>
                <input v-model.number="newExpense.amount" type="number" placeholder="金額" class="w-full bg-slate-50 rounded-xl p-4 pl-8 text-sm outline-none focus:ring-2 focus:ring-accent-yellow font-bold text-lg">
            </div>
            <div class="flex space-x-3 mb-6">
                <button @click="newExpense.payment='cash'" :class="newExpense.payment==='cash' ? 'bg-deep-sea-blue text-white' : 'bg-slate-100 text-slate-500'" class="flex-1 py-3 rounded-xl text-sm transition-colors"><i class="fa-solid fa-coins mr-1"></i> 現金</button>
                <button @click="newExpense.payment='card'" :class="newExpense.payment==='card' ? 'bg-deep-sea-blue text-white' : 'bg-slate-100 text-slate-500'" class="flex-1 py-3 rounded-xl text-sm transition-colors"><i class="fa-solid fa-credit-card mr-1"></i> 信用卡</button>
            </div>
            <div class="flex space-x-3">
                <button @click="showExpenseModal = false" class="flex-1 py-3 rounded-xl bg-slate-100 text-slate-500 font-bold text-sm">取消</button>
                <button @click="addExpense" class="flex-1 py-3 rounded-xl bg-accent-yellow text-deep-sea-blue font-bold text-sm shadow-lg shadow-accent-yellow/30">儲存</button>
            </div>
        </div>
    </div>
    
    <div v-if="showItineraryModal" class="fixed inset-0 bg-deep-sea-blue/40 z-50 flex items-center justify-center p-6 backdrop-blur-sm animate-fade-in">
        <div class="bg-white rounded-3xl w-full max-w-sm p-6 shadow-2xl max-h-[90vh] overflow-y-auto">
            <h3 class="font-bold text-lg mb-5 text-center text-slate-800">{{ isEditMode ? '編輯行程' : '新增行程' }}</h3>
            <div class="space-y-3">
                <select v-model="newItinerary.category" class="w-full bg-slate-50 rounded-xl p-3 text-sm outline-none">
                    <option value="sightseeing">景點</option>
                    <option value="food">飲食</option>
                    <option value="shopping">購物</option>
                    <option value="accommodation">住宿</option>
                    <option value="flight">航班</option>
                    <option value="transport">交通</option>
                    <option value="ticket">門票</option>
                    <option value="other">其他</option>
                </select>
                <input v-model="newItinerary.name" placeholder="名稱" class="w-full bg-slate-50 rounded-xl p-3 text-sm outline-none focus:ring-2 focus:ring-deep-sea-blue">
                <input v-model="newItinerary.address" placeholder="地址/地點 (Google Map 搜尋用)" class="w-full bg-slate-50 rounded-xl p-3 text-sm outline-none focus:ring-2 focus:ring-deep-sea-blue">
                <div class="grid grid-cols-2 gap-3">
                    <input v-model="newItinerary.startTime" type="text" placeholder="時間 (e.g. 09:30)" class="bg-slate-50 rounded-xl p-3 text-sm outline-none">
                    <select v-model="newItinerary.transportType" class="bg-slate-50 rounded-xl p-3 text-sm outline-none">
                        <option value="walk">步行</option>
                        <option value="car">自駕</option>
                        <option value="bus">巴士</option>
                        <option value="public">地鐵/JR</option>
                        <option value="flight">飛機</option>
                        <option value="other">其他</option>
                    </select>
                </div>
                <div class="grid grid-cols-2 gap-3">
                    <input v-model="newItinerary.travelTime" type="text" placeholder="車程/移動時間" class="bg-slate-50 rounded-xl p-3 text-sm outline-none">
                    <input v-model="newItinerary.hours" type="text" placeholder="營業時間" class="bg-slate-50 rounded-xl p-3 text-sm outline-none">
                </div>
                <input v-model="newItinerary.price" type="text" placeholder="門票/費用" class="w-full bg-slate-50 rounded-xl p-3 text-sm outline-none focus:ring-2 focus:ring-deep-sea-blue">
                <textarea v-model="newItinerary.note" placeholder="備註/細節" rows="3" class="w-full bg-slate-50 rounded-xl p-3 text-sm outline-none focus:ring-2 focus:ring-deep-sea-blue"></textarea>
            </div>
            <div class="flex space-x-3 mt-6">
                <button @click="showItineraryModal = false; isEditMode = false" :class="isEditMode ? 'w-1/3' : 'flex-1'" class="py-3 rounded-xl bg-slate-100 text-slate-500 font-bold text-sm">取消</button>
                
                <button v-if="isEditMode" @click="removeItineraryItem(newItinerary.id)" class="w-1/3 py-3 rounded-xl bg-red-100 text-red-600 font-bold text-sm hover:bg-red-200 transition-colors">
                    <i class="fa-solid fa-trash-can mr-1"></i> 刪除
                </button>
                
                <button @click="saveItineraryItem" :class="isEditMode ? 'w-1/3' : 'flex-1'" class="py-3 rounded-xl bg-deep-sea-blue text-white font-bold text-sm shadow-lg shadow-deep-sea-blue/30">{{ isEditMode ? '儲存修改' : '新增行程' }}</button>
            </div>
        </div>
    </div>


</div> <script>
    const { createApp, ref, computed, onMounted } = Vue

    createApp({
        setup() {
            // 匯率基準
            const EXCHANGE_RATE = 0.205;

            // 標籤顏色與圖示定義
            const CATEGORY_MAP = {
                sightseeing: { color: 'bg-green-500', icon: 'fa-solid fa-camera' },
                food: { color: 'bg-red-500', icon: 'fa-solid fa-utensils' },
                shopping: { color: 'bg-indigo-500', icon: 'fa-solid fa-bag-shopping' },
                accommodation: { color: 'bg-purple-500', icon: 'fa-solid fa-bed' },
                flight: { color: 'bg-blue-500', icon: 'fa-solid fa-plane-departure' },
                transport: { color: 'bg-orange-500', icon: 'fa-solid fa-car' },
                ticket: { color: 'bg-cyan-500', icon: 'fa-solid fa-ticket' },
                other: { color: 'bg-slate-500', icon: 'fa-solid fa-circle-info' },
                stay: { color: 'bg-purple-500', icon: 'fa-solid fa-hotel' }, 
            };
            const CATEGORY_LABEL_MAP = {
                sightseeing: '景點', food: '飲食', shopping: '購物', accommodation: '住宿', flight: '航班', transport: '交通', ticket: '門票', other: '其他', stay: '住宿'
            };

            // 當前頁面
            const currentTab = ref('itinerary');

            // --- 資料定義：已根據使用者最新行程全部更新 ---
            
            const dates = ref([
                { date: '2/5', weekday: '四', hasCar: false, tollFee: 0 },
                { date: '2/6', weekday: '五', hasCar: false, tollFee: 0 }, 
                { date: '2/7', weekday: '六', hasCar: false, tollFee: 0 },
                { date: '2/8', weekday: '日', hasCar: false, tollFee: 0 },
                { date: '2/9', weekday: '一', hasCar: false, tollFee: 0 },
                { date: '2/10', weekday: '二', hasCar: false, tollFee: 0 }, 
                { date: '2/11', weekday: '三', hasCar: false, tollFee: 0 },
{ date: '2/12', weekday: '四', hasCar: false, tollFee: 0 },
            ]);
// hotels 定義
const hotels = ref([
    { 
        name: 'Ueno Woo Hotel 《上野 窩 旅店》', 
        date: '2/5 - 2/12 (7晚)', 
        phone: '+81361612288', 
        address: '〒110-0015 東京都台東区東上野２丁目４−1' 
    },
]);

const itineraryData = ref([
    // ==================== Day 1: 2/5 (四) 成田機場 ＞ 上野 ====================
    [
        {
            id: 101,
            name: '桃園機場報到',
            category: 'flight',
            startTime: '9:35',
            address: '桃園國際機場 (TPE)',
            note: '中華航空 CI104 12:35起飛',
            hours: null,
            price: null,
            transportType: 'flight',
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 102,
            name: '成田機場 (NRT) 抵達',
            category: 'flight',
            startTime: '16:35',
            address: '成田機場 (NRT)',
            note: '領取行李與找skyline京成快線月台',
            hours: null,
            price: null,
            transportType: 'flight',
            travelTime: '4h0m',
            isNoteExpanded: false
        },
        {
            id: 103,
            name: '搭乘skyline京成快線至上野車站',
            category: 'transport',
            startTime: '~18:30',
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: '國內線??站台搭車，車程約40分鐘走路15分鐘。',
            hours: null,
            price: '約 ¥2,300/人',
            transportType: 'public',
            travelTime: '30m',
            isNoteExpanded: false
        },
        {
            id: 104,
            name: 'OS drug 上野藥妝店',
            category: 'shopping',
            startTime: null,
            address: 'OS drug 上野藥妝店',
            note: '從車站會經過，藥妝無法退稅現金價買牙膏、足貼',
            hours: '10:00-19:45',
            price: null,
            transportType: 'walk',
            travelTime: '1h',
            isNoteExpanded: false
        },
        {
            id: 105,
            name: 'Ueno Woo Hotel 《上野 窩 旅店》 Check-in',
            category: 'accommodation',
            startTime: '~19:30',
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: null,
            hours: '~21:00',
            price: null,
            transportType: 'walk',
            travelTime: '15m',
            isNoteExpanded: false
        },
        {
            id: 106,
            name: '晚餐 (還沒想)',
            category: 'food',
            startTime: '~20:00',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '15m',
            isNoteExpanded: false
        },
        {
            id: 107,
            name: 'Uniqlo 上野廣小路店',
            category: 'shopping',
            startTime: '~21:00',
            address: 'Uniqlo 上野廣小路店',
            note: '買手套、衣服',
            hours: '10:00~21:30',
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 108,
            name: '阿美橫町、多慶屋',
            category: 'shopping',
            startTime: null,
            address: null,
            note: '去 lawson 拿 wf 票',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        }
    ],

    // ==================== Day 2: 2/6 (五) 代代木 ＞ 下北澤 ＞ 六本木 ====================
    [
        {
            id: 201,
            name: '集合',
            category: null,
            startTime: '8:00',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 202,
            name: '吃吐司｜Fuglen Tokyo',
            category: 'food',
            startTime: '9:00~9:45',
            address: 'Fuglen Tokyo',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【60min】走7min>稻荷町>(13站)>表參道>走2min>表參道>(2站)>代代木公園>走5min',
            isNoteExpanded: false
        },
        {
            id: 203,
            name: '喝咖啡 | nadoya no katte 日式庭院',
            category: 'food',
            startTime: '10:00-11:45',
            address: 'nadoya no katte',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: 'A【15min】搭車  代代木公園站>(1站)>代代木上原站 B【18min】走路',
            isNoteExpanded: false
        },
        {
            id: 204,
            name: '老帽 | sowhat vintage',
            category: 'shopping',
            startTime: '12:00-12:20',
            address: 'sowhat vintage',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【12min】走5min>代代木上原站>(2站)>下北沢',
            isNoteExpanded: false
        },
        {
            id: 205,
            name: '古著 | FORESTIÈRE',
            category: 'shopping',
            startTime: '12:30-13:00',
            address: 'FORESTIÈRE',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【5min】走5min',
            isNoteExpanded: false
        },
        {
            id: 206,
            name: '古著 | FRONT11201 本店',
            category: 'shopping',
            startTime: '13:20-14:10',
            address: 'FRONT11201 本店',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【16min】走7min>東北澤>(2站)>代代木八幡站>走3min',
            isNoteExpanded: false
        },
        {
            id: 207,
            name: '古著 | BACKDOOR',
            category: 'shopping',
            startTime: '14:15-14:45',
            address: 'BACKDOOR',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【3min】走3min',
            isNoteExpanded: false
        },
        {
            id: 208,
            name: '老球鞋 | PLAYGROUND',
            category: 'shopping',
            startTime: '14:55-15:10',
            address: 'PLAYGROUND',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【9min】走9min',
            isNoteExpanded: false
        },
        {
            id: 209,
            name: '吃拉麵｜入鹿Tokyo 米其林推薦',
            category: 'food',
            startTime: '15:30-16:30',
            address: '入鹿Tokyo',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【17min】代代木公園站>(3站)>乃木坂>走9min',
            isNoteExpanded: false
        },
        {
            id: 210,
            name: '麻布台之丘 | Teamlab',
            category: 'sightseeing',
            startTime: '17:00-17:30',
            address: '麻布台之丘Teamlab',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【15min】走6min>六本木>(1站)>神谷町>走3min',
            isNoteExpanded: false
        },
        {
            id: 211,
            name: '麻布台之丘 34F | 喝 Hills House Sky Room Café&Bar',
            category: 'food',
            startTime: '17:50~19:00',
            address: 'Hills House Sky Room Café&Bar',
            note: '看東京鐵塔夜景',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【11min】走11min',
            isNoteExpanded: false
        },
        {
            id: 212,
            name: '吃天婦羅｜Tempura Mikaku',
            category: 'food',
            startTime: '19:30-20:30',
            address: 'Tempura Mikaku',
            note: '已預約',
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【45min】走7min>六本木>(13站)>仲御徒町站>走10min',
            isNoteExpanded: false
        },
        {
            id: 213,
            name: '看點燈｜路易威登 六本木新城店',
            category: 'sightseeing',
            startTime: '~21:00',
            address: '路易威登 六本木新城店',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【11min】走11min',
            isNoteExpanded: false
        },
        {
            id: 214,
            name: '到飯店',
            category: 'accommodation',
            startTime: '22:30',
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '1h',
            isNoteExpanded: false
        }
    ],

    // ==================== Day 3: 2/7 (六) 中野 ＞ 新宿 ====================
    [
        {
            id: 301,
            name: '集合',
            category: null,
            startTime: '8:00',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 302,
            name: 'solo sofubi exhibition',
            category: 'shopping',
            startTime: '~11:00',
            address: '4-chōme-20-1 Higashiueno',
            note: 'uenoma gallery',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【15min】走15min',
            isNoteExpanded: false
        },
        {
            id: 303,
            name: '吃早餐｜EGG BABY CAFE',
            category: 'food',
            startTime: '10:00-11:00',
            address: 'EGG BABY CAFE',
            note: '早餐要吃飽',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【20min】走20min',
            isNoteExpanded: false
        },
        {
            id: 304,
            name: '百老匯3F｜墓場の画廊 11:00',
            category: 'shopping',
            startTime: '11:40',
            address: '中野墓場の画廊',
            note: null,
            hours: '11:00-20:00',
            price: null,
            transportType: 'public',
            travelTime: '【45min】',
            isNoteExpanded: false
        },
        {
            id: 305,
            name: '百老匯4F｜村上隆專賣店 12:00',
            category: 'shopping',
            startTime: '12:20',
            address: '中野村上隆專賣店',
            note: null,
            hours: '12:00-18:00',
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 306,
            name: '百老匯2-4F｜Mandarake Nakano 有30幾家',
            category: 'shopping',
            startTime: '12:40-14:40',
            address: '中野Mandarake Nakano',
            note: '有30幾家',
            hours: '12:00-20:00',
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 307,
            name: '百老匯2F｜喝村上隆咖啡廳 12:00',
            category: 'food',
            startTime: '14:50-15:20',
            address: '中野村上隆咖啡廳',
            note: null,
            hours: '12:00-20:00',
            price: null,
            transportType: 'public',
            travelTime: '【15min】走7min>中野(東京)>(1站)>高圓寺',
            isNoteExpanded: false
        },
        {
            id: 308,
            name: '# 鰻魚飯｜名代 宇奈鰻魚飯 中野店',
            category: 'food',
            startTime: null,
            address: '名代 宇奈鰻魚飯 中野店',
            note: '餓的話先吃點',
            hours: '11:00-22:00',
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 309,
            name: '高圓寺PAL商店街古著街',
            category: 'shopping',
            startTime: '15:35',
            address: '高圓寺PAL商店街古著街',
            note: '時間不夠可考慮不去',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【1min】走1min',
            isNoteExpanded: false
        },
        {
            id: 310,
            name: '精品古著｜Atlantis Vintage Tokyo',
            category: 'shopping',
            startTime: '15:35-16:00',
            address: 'Atlantis Vintage Tokyo',
            note: '精品古著｜時間不夠可考慮不去',
            hours: '11:00-19:00',
            price: null,
            transportType: 'public',
            travelTime: '【25min】走5min>高圓寺車站>(4站)>新宿>走6min',
            isNoteExpanded: false
        },
        {
            id: 311,
            name: '吃法式吐司｜Cafe Aaliya',
            category: 'food',
            startTime: '16:30',
            address: 'Cafe Aaliya',
            note: '吃法式吐司',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 312,
            name: '哥商｜Godzilla Store Tokyo',
            category: 'shopping',
            startTime: '16:40-17:10',
            address: 'Godzilla Store Tokyo',
            note: '買金幣',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【2min】走2min',
            isNoteExpanded: false
        },
        {
            id: 313,
            name: '6F Carhartt',
            category: 'shopping',
            startTime: '17:20-40',
            address: 'LUMINE EST新宿',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【8min】走8min',
            isNoteExpanded: false
        },
        {
            id: 314,
            name: '6F Rageblue',
            category: 'shopping',
            startTime: '17:40-18:00',
            address: 'LUMINE EST新宿',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 315,
            name: '1-1F Barbour LUMINE Shinjuku',
            category: 'shopping',
            startTime: '18:10',
            address: 'LUMINE Shinjuku 1',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【6min】走6min',
            isNoteExpanded: false
        },
        {
            id: 316,
            name: 'B1-1F UNITED ARROWS SHINJUKU',
            category: 'shopping',
            startTime: '18:20-18:40',
            address: 'LUMINE Shinjuku 1',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 317,
            name: '19F 吃壽司｜Sushi｜Yurakucho Kakida｜Tokyo',
            category: 'food',
            startTime: '19:00-21:00',
            address: 'Sushi｜Yurakucho Kakida｜Tokyo',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【6min】走6min',
            isNoteExpanded: false
        },
        {
            id: 318,
            name: '[A] 格拉斯麗新宿酒店/歌舞伎町',
            category: 'sightseeing',
            startTime: '21:30',
            address: '格拉斯麗新宿酒店',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【22min】走22min 或搭車 時間一樣',
            isNoteExpanded: false
        },
        {
            id: 319,
            name: '[B] 東京都廳第一本廳舍 南展望室 45f',
            category: 'sightseeing',
            startTime: '21:20',
            address: '東京都廳第一本廳舍 南展望室 45f',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【15min】走5min>新宿車站>(1站)>都廳前>走6min',
            isNoteExpanded: false
        },
        {
            id: 320,
            name: '回上野飯店附近',
            category: 'accommodation',
            startTime: null,
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 321,
            name: '買明天的物資',
            category: 'shopping',
            startTime: null,
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        }
    ],

    // ==================== Day 4: 2/8 (日) 千葉 ＞ 秋葉原 ====================
    [
        {
            id: 401,
            name: '集合',
            category: null,
            startTime: '6:00',
            address: '集合',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 402,
            name: '千葉幕張展覽館｜wonder festival',
            category: 'shopping',
            startTime: '7:30',
            address: '千葉幕張展覽館｜wonder festival',
            note: '10:00 進場',
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【90min】要轉車',
            isNoteExpanded: false
        },
        {
            id: 403,
            name: '回飯店',
            category: 'accommodation',
            startTime: '16:00',
            address: '回飯店',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: 'A【90min】要轉車',
            isNoteExpanded: false
        },
        {
            id: 404,
            name: '居酒屋｜串焼きと天ぷら 春子屋',
            category: 'food',
            startTime: null,
            address: '居酒屋｜串焼きと天ぷら 春子屋',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 405,
            name: '秋葉原 吃豬排｜丸五',
            category: 'food',
            startTime: '17:30-18:30',
            address: '秋葉原 吃豬排｜丸五',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: 'B【75min】要轉車',
            isNoteExpanded: false
        },
        {
            id: 406,
            name: '軟膠｜Mandarake CoCoo',
            category: 'shopping',
            startTime: '19:00-20:00',
            address: '軟膠｜Mandarake CoCoo',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【4min】走4min',
            isNoteExpanded: false
        },
        {
            id: 407,
            name: '回飯店',
            category: 'accommodation',
            startTime: '20:30',
            address: '回飯店',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【22min】',
            isNoteExpanded: false
        }
    ],

    // ==================== Day 5: 2/9 (一) 原宿＞涉谷 ====================
    [
        {
            id: 501,
            name: '集合',
            category: null,
            startTime: '8:00',
            address: '集合',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 502,
            name: 'LATTE ART MANIA TOKYO 東京店 要吃超飽',
            category: 'food',
            startTime: '9:00',
            address: 'LATTE ART MANIA TOKYO 東京店',
            note: '要吃超飽',
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【37min】走7min>稻荷町(東京)>(14站)>外苑前>走4min',
            isNoteExpanded: false
        },
        {
            id: 503,
            name: '喝咖啡｜HUMAN MADE 咖啡 by 藍瓶咖啡',
            category: 'food',
            startTime: '10:40-11:00',
            address: 'HUMAN MADE 咖啡 by 藍瓶咖啡',
            note: '喝咖啡',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【6min】走6min',
            isNoteExpanded: false
        },
        {
            id: 504,
            name: 'HUMAN MADE OFFLINE STORE',
            category: 'shopping',
            startTime: '11:00-11:30',
            address: 'HUMAN MADE OFFLINE STORE',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 505,
            name: '平價銀飾｜CHARCOAL*GREEN Tokyo',
            category: 'shopping',
            startTime: '11:40',
            address: 'CHARCOAL*GREEN Tokyo',
            note: '平價銀飾',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【3min】走3min',
            isNoteExpanded: false
        },
        {
            id: 506,
            name: 'UNITED ARROWS 原宿本店',
            category: 'shopping',
            startTime: '12:00',
            address: 'UNITED ARROWS 原宿本店',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 507,
            name: 'BEAMS Women Harajuku',
            category: 'shopping',
            startTime: '12:20',
            address: 'BEAMS Women Harajuku',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 508,
            name: 'BEAMS 原宿',
            category: 'shopping',
            startTime: '12:40',
            address: 'BEAMS 原宿',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 509,
            name: "I can't give you anything but knit by gim",
            category: 'shopping',
            startTime: '13:00',
            address: "I can't give you anything but knit by gim",
            note: '日本針織老牌',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 510,
            name: 'Noah Clubhouse',
            category: 'shopping',
            startTime: '13:10',
            address: 'Noah Clubhouse',
            note: '英倫感街頭風',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 511,
            name: 'thisisneverthat 東京旗艦店',
            category: 'shopping',
            startTime: '13:20',
            address: 'thisisneverthat 東京旗艦店',
            note: '韓國設計品牌',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 512,
            name: 'STUSSY Harajuku Chapter',
            category: 'shopping',
            startTime: '13:25',
            address: 'STUSSY Harajuku Chapter',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 513,
            name: 'Carhartt WIP Store Tokyo Harajuku',
            category: 'shopping',
            startTime: '13:30-14:10',
            address: 'Carhartt WIP Store Tokyo Harajuku',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 514,
            name: 'Supreme 原宿',
            category: 'shopping',
            startTime: '14:10',
            address: 'Supreme 原宿',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 515,
            name: 'NEIGHBORHOOD HARAJUKU',
            category: 'shopping',
            startTime: '14:15',
            address: 'NEIGHBORHOOD HARAJUKU',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 516,
            name: "BILLY'S HARAJUKU (球鞋)",
            category: 'shopping',
            startTime: '14:20',
            address: "BILLY'S HARAJUKU (球鞋)",
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 517,
            name: 'Laforet 1-2F - HUMAN MADE',
            category: 'shopping',
            startTime: '14:25-14:55',
            address: 'Laforet 1-2F - HUMAN MADE',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 518,
            name: '吃拉麵｜Oreryū Shio Ramen Jingūmae',
            category: 'food',
            startTime: '15:30-16:30',
            address: 'Oreryū Shio Ramen Jingūmae',
            note: '吃拉麵+鹹酥雞必點',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 519,
            name: '古著精品｜Paradise vintage',
            category: 'shopping',
            startTime: '16:30',
            address: 'Paradise vintage',
            note: '古著精品',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 520,
            name: 'On Store Tokyo Cat Street',
            category: 'shopping',
            startTime: null,
            address: 'On Store Tokyo Cat Street',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 521,
            name: 'The North Face Standard(紫標)',
            category: 'shopping',
            startTime: '16:50-17:30',
            address: 'The North Face Standard(紫標)',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 522,
            name: 'THE NORTH FACE 3(march)女款',
            category: 'shopping',
            startTime: '17:30-18:00',
            address: 'THE NORTH FACE 3(march)女款',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 523,
            name: 'Barbour原宿キャットストリート店',
            category: 'shopping',
            startTime: '18:00',
            address: 'Barbour原宿キャットストリート店',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 524,
            name: "BILLY'S ENT Shibuya",
            category: 'shopping',
            startTime: '18:00',
            address: "BILLY'S ENT Shibuya",
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 525,
            name: 'KITH 東京店 (球鞋)',
            category: 'shopping',
            startTime: '18:05',
            address: 'KITH 東京店 (球鞋)',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 526,
            name: 'DULTON Jinnan Shop (雜貨用品裝飾)',
            category: 'shopping',
            startTime: '18:10-18:30',
            address: 'DULTON Jinnan Shop',
            note: '雜貨用品裝飾',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 527,
            name: 'MIDWEST Tokyo Shop',
            category: 'shopping',
            startTime: '18:30',
            address: 'MIDWEST Tokyo Shop',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 528,
            name: 'BEAMS 澀谷店 （男裝）',
            category: 'shopping',
            startTime: '18:35',
            address: 'BEAMS 澀谷店 （男裝）',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 529,
            name: 'nano・universe',
            category: 'shopping',
            startTime: '18:45',
            address: 'nano・universe',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 530,
            name: "FREAK'S STORE Shibuya",
            category: 'shopping',
            startTime: '18:55',
            address: "FREAK'S STORE Shibuya",
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 531,
            name: 'RAGEBLUE 渋谷',
            category: 'shopping',
            startTime: '19:05',
            address: 'RAGEBLUE 渋谷',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 532,
            name: '古著 | 3F BINGO Shibuya MODI Store',
            category: 'shopping',
            startTime: '19:10',
            address: '古著 | 3F BINGO Shibuya MODI Store',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 533,
            name: '涉谷parco3F  有可能有紫標THE NORTH FACE LAB',
            category: 'shopping',
            startTime: '19:25',
            address: 'THE NORTH FACE LAB',
            note: '涉谷parco3F  有可能有紫標',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 534,
            name: '涉谷parco4F MEDICOM TOY NEXT',
            category: 'shopping',
            startTime: '19:45',
            address: 'MEDICOM TOY NEXT',
            note: '涉谷parco4F',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 535,
            name: '涉谷parco 6F Godzilla Store Shibuya',
            category: 'shopping',
            startTime: '19:50',
            address: 'Godzilla Store Shibuya',
            note: '涉谷parco 6F',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 536,
            name: '吃蛋包飯｜EDW yellow Shibuya',
            category: 'food',
            startTime: '20:00',
            address: 'EDW yellow Shibuya',
            note: '要現場排，吃蛋包飯或別的',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 537,
            name: '回飯店',
            category: 'accommodation',
            startTime: null,
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        }
    ],

    // ==================== Day 6: 2/10 (二) 淺草＞銀座 ====================
    [
        {
            id: 601,
            name: '集合',
            category: null,
            startTime: '8:30',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 602,
            name: '雷門 拍照',
            category: 'sightseeing',
            startTime: '9:00-9:10',
            address: '雷門',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【20min】走7min>稻荷町(東京)>(2站)>淺草>走4min',
            isNoteExpanded: false
        },
        {
            id: 603,
            name: 'Yoroshi Cosmetics よろし化粧堂 仲見世店',
            category: 'shopping',
            startTime: null,
            address: 'Yoroshi Cosmetics よろし化粧堂 仲見世店',
            note: '必買護手霜',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 604,
            name: '淺草寺',
            category: 'sightseeing',
            startTime: '9:20',
            address: '淺草寺',
            note: '沿著仲見世商店街',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【4min】走4min',
            isNoteExpanded: false
        },
        {
            id: 605,
            name: '求事業 | 被官稻荷神社(靈狐)',
            category: 'sightseeing',
            startTime: '9:40',
            address: '被官稻荷神社',
            note: '(靈狐)',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【2min】走2min',
            isNoteExpanded: false
        },
        {
            id: 606,
            name: '求金 | 錢塚地藏堂',
            category: 'sightseeing',
            startTime: '10:00',
            address: '錢塚地藏堂',
            note: '求金',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【5min】走5min',
            isNoteExpanded: false
        },
        {
            id: 607,
            name: '吃麵包｜花月堂',
            category: 'food',
            startTime: '10:20',
            address: '花月堂',
            note: '吃麵包',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【3min】走3min',
            isNoteExpanded: false
        },
        {
            id: 608,
            name: '吃抹茶泡芙｜雷一茶 傳法院通店',
            category: 'food',
            startTime: '10:40',
            address: '雷一茶 傳法院通店',
            note: '吃抹茶泡芙',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【6min】走6min',
            isNoteExpanded: false
        },
        {
            id: 609,
            name: '#章魚燒｜Taco-Taco Asakusa Koromo Brothers',
            category: 'food',
            startTime: null,
            address: 'Taco-Taco Asakusa Koromo Brothers',
            note: '#章魚燒 聽說偏雷',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 610,
            name: '#淺草吉備糰子 AZUMA',
            category: 'food',
            startTime: null,
            address: '淺草吉備糰子 AZUMA',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 611,
            name: '吃淺草絲滑布丁',
            category: 'food',
            startTime: '11:00',
            address: '吃淺草絲滑布丁',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【4min】走4min',
            isNoteExpanded: false
        },
        {
            id: 612,
            name: '吃鰻魚飯｜Unagi Irokawa 160年',
            category: 'food',
            startTime: '11:15-12:30',
            address: 'Unagi Irokawa 160年',
            note: '吃 160年鰻魚飯',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【5min】走5min',
            isNoteExpanded: false
        },
        {
            id: 613,
            name: '喝咖啡｜Glitch Coffee and Roasters GINZA',
            category: 'food',
            startTime: null,
            address: 'Glitch Coffee and Roasters GINZA',
            note: '亞洲top50 喝咖啡',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 614,
            name: 'ISSEY MIYAKE 銀座 / 445',
            category: 'shopping',
            startTime: '13:00-13:20',
            address: 'ISSEY MIYAKE 銀座 / 445',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 615,
            name: 'on 鞋子 | Atmos Ginza',
            category: 'shopping',
            startTime: '13:25-13:55',
            address: 'Atmos Ginza',
            note: 'on 鞋子',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走2min',
            isNoteExpanded: false
        },
        {
            id: 616,
            name: '1-7F | DOVER STREET MARKET 銀座',
            category: 'shopping',
            startTime: '14:00-14:30',
            address: 'DOVER STREET MARKET 銀座',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走6min',
            isNoteExpanded: false
        },
        {
            id: 617,
            name: '1-12F | Uniqlo Ginza Flagship Store',
            category: 'shopping',
            startTime: '14:30-15:00',
            address: 'Uniqlo Ginza Flagship Store',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走1min',
            isNoteExpanded: false
        },
        {
            id: 618,
            name: '5F 逛北臉紫標 | THE NORTH FACE UNLIMITED Ginza Six店',
            category: 'shopping',
            startTime: '15:05-15:40',
            address: 'THE NORTH FACE UNLIMITED Ginza Six店',
            note: '5F 逛北臉紫標',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走4min',
            isNoteExpanded: false
        },
        {
            id: 619,
            name: '#抹茶刨冰 | HIIRAGI 銀座本店 ひいらぎ 銀座本店',
            category: 'food',
            startTime: '15:45',
            address: 'HIIRAGI 銀座本店 ひいらぎ 銀座本店',
            note: '盆景的茶點 #抹茶刨冰',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走4min',
            isNoteExpanded: false
        },
        {
            id: 620,
            name: '吃熱壓吐司｜ROAR COFFEE Tokyo Ginza',
            category: 'food',
            startTime: '16:20-17:00',
            address: 'ROAR COFFEE Tokyo Ginza',
            note: '吃熱壓吐司',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走8min',
            isNoteExpanded: false
        },
        {
            id: 621,
            name: '吃拉麵｜銀座八五',
            category: 'food',
            startTime: '17:30-18:00',
            address: '銀座八五',
            note: '2/3 要預約吃拉麵',
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走2min',
            isNoteExpanded: false
        },
        {
            id: 622,
            name: 'Uniqlo Tokyo',
            category: 'shopping',
            startTime: '18:10-18:40',
            address: 'Uniqlo Tokyo',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 623,
            name: '領鑰匙圈 丸之內北口的出口 JR 服務處 1F',
            category: 'sightseeing',
            startTime: '19:00 截止',
            address: '領鑰匙圈 丸之內北口的出口 JR 服務處 1F',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【14min】走5min>銀座>(1站)>東京車站>走2min',
            isNoteExpanded: false
        },
        {
            id: 624,
            name: '新丸之內大廈 7F 推薦夜景的東京車站',
            category: 'sightseeing',
            startTime: '20:30',
            address: '新丸之內大廈 7F',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '【7min】走7min',
            isNoteExpanded: false
        },
        {
            id: 625,
            name: '回飯店',
            category: 'accommodation',
            startTime: null,
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        }
    ],

    // ==================== Day 7: 2/11 (三) 池袋＞秋葉原 ====================
    [
        {
            id: 701,
            name: '集合',
            category: null,
            startTime: '8:00',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 702,
            name: '明治神宮',
            category: 'sightseeing',
            startTime: '9:00',
            address: '明治神宮前站',
            note: '10:00 有遊行',
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【60min】走6min>新御徒町車站>(8站)>東新宿>走4min>東新宿>(3站)>明治神宮前>走20min',
            isNoteExpanded: false
        },
        {
            id: 703,
            name: '吃咖哩｜curry up',
            category: 'food',
            startTime: '11:00-12:30',
            address: '原宿curry up',
            note: '現場排隊，谷歌寫11:00/tablelog 11:30',
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 704,
            name: '池袋 扭蛋的森林',
            category: 'shopping',
            startTime: '13:10-14:30',
            address: '池袋 扭蛋的森林',
            note: '3000台扭蛋機',
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【40min】走9min>原宿>(6站)>池袋>走14min',
            isNoteExpanded: false
        },
        {
            id: 705,
            name: '秋葉原 bicCamera',
            category: 'shopping',
            startTime: '15:30-16:20',
            address: '秋葉原 bicCamera',
            note: null,
            hours: null,
            price: null,
            transportType: 'public',
            travelTime: '【40min】走14min>池袋>(6站)>淡路町>走7min',
            isNoteExpanded: false
        },
        {
            id: 706,
            name: '軟膠 madaraka COCO',
            category: 'shopping',
            startTime: '16:30-17:30',
            address: 'madaraka COCO',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走6min',
            isNoteExpanded: false
        },
        {
            id: 707,
            name: '秋葉原 吃豬排｜丸五 17:00-20:00',
            category: 'food',
            startTime: '17:40-18:30',
            address: '丸五豬排秋葉原店',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走7min',
            isNoteExpanded: false
        }
    ],

    // ==================== Day 8: 2/12 (四) 回家 ====================
    [
        {
            id: 801,
            name: '集合 去吃早餐',
            category: null,
            startTime: '8:00',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 802,
            name: '大國買藥妝御徒町店',
            category: 'shopping',
            startTime: null,
            address: '大國買藥妝御徒町店',
            note: null,
            hours: '09:35-22:50',
            price: null,
            transportType: 'walk',
            travelTime: '走5min',
            isNoteExpanded: false
        },
        {
            id: 803,
            name: '松本清御徒町站前店',
            category: 'shopping',
            startTime: null,
            address: '松本清御徒町站前店',
            note: null,
            hours: '10:00-23:00',
            price: null,
            transportType: 'walk',
            travelTime: '走1min',
            isNoteExpanded: false
        },
        {
            id: 804,
            name: 'checkout 寄放行李在飯店',
            category: 'accommodation',
            startTime: null,
            address: 'Ueno Woo Hotel 《上野 窩 旅店》',
            note: null,
            hours: null,
            price: null,
            transportType: 'walk',
            travelTime: '走4min',
            isNoteExpanded: false
        },
        {
            id: 805,
            name: '吃燒肉敘敘苑｜上野不忍口店',
            category: 'food',
            startTime: '11:00',
            address: '敘敘苑上野不忍口店',
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 806,
            name: '成田機場 T2 第二航廈集合，華航航空 CI109',
            category: 'flight',
            startTime: '16:35',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 807,
            name: '起飛 成田機場 T2',
            category: 'flight',
            startTime: '19:30',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        },
        {
            id: 808,
            name: '抵達 桃園機場 T2',
            category: 'flight',
            startTime: '22:45',
            address: null,
            note: null,
            hours: null,
            price: null,
            transportType: null,
            travelTime: null,
            isNoteExpanded: false
        }
    ]
]);

            // 預設天氣資訊
            const weatherData = ref([
                { condition: 'sunny', temp: '15/3', feel: '13' },
                { condition: 'sunny', temp: '15/4', feel: '12' },
                { condition: 'cloudy', temp: '9/2', feel: '5' },
                { condition: 'sunny', temp: '7/0', feel: '4' },
                { condition: 'sunny', temp: '8/-1', feel: '5' },
                { condition: 'sunny', temp: '10/0', feel: '7' },
                { condition: 'cloudy', temp: '12/2', feel: '5' },
{ condition: 'sunny', temp: '13/4', feel: '6' },
            ]);
            
            // 購物清單 (範例資料)
            const shoppingList = ref([
                { name: '參天SANTE Soft Santear潤澤人工淚液眼藥水5ml×4', image: 'https://www.dkglobal-daikokudrug.com/items/M0000841' },
                { name: 'LeTAO 雙層起司蛋糕', image: 'https://via.placeholder.com/100/f0f9ff/005e8a?text=LeTAO' },
                { name: '薯條三兄弟', image: 'https://via.placeholder.com/100/f0f9ff/005e8a?text=JagaPockle' },
            ]);

            // 花費紀錄 (範例資料)
            const expenses = ref([
                { name: '機票費用', amount: 19000, category: 'flight', date: '2026-01-15', payment: 'card' },
                { name: 'Ueno Woo Hotel 《上野 窩 旅店》', amount: 21000, category: 'stay', date: '2026-01-20', payment: 'card' },
            ]);

            // --- 狀態控制 ---
            const selectedDateIndex = ref(0);
            const showShoppingModal = ref(false);
            const showExpenseModal = ref(false);
            const showItineraryModal = ref(false);
            const isEditMode = ref(false); 
            
            // 新增/編輯行程狀態
            const newItinerary = ref({
                id: null, name: '', category: 'sightseeing', startTime: '', hours: '', address: '', price: '', note: '', transportType: 'car', travelTime: '', isNoteExpanded: false
            });
            // 新增購物狀態
            const newShoppingItem = ref({
                name: '', image: null
            });
            // 新增花費狀態
            const newExpense = ref({
                name: '', amount: null, category: 'food', date: new Date().toISOString().substring(0, 10), payment: 'cash'
            });

            // 貨幣轉換
            const currencyInput = ref(50000);
            const currencyResult = ref(0);
            
            // --- Computed Properties ---
            
            const currentItinerary = computed(() => {
                if (!itineraryData.value[selectedDateIndex.value]) {
                    itineraryData.value[selectedDateIndex.value] = [];
                }
                return itineraryData.value[selectedDateIndex.value];
            });

            const totalExpensesJPY = computed(() => {
                return expenses.value.reduce((sum, exp) => sum + exp.amount, 0);
            });

            const totalExpensesTWD = computed(() => {
                return Math.round(totalExpensesJPY.value * EXCHANGE_RATE);
            });

            // --- Methods ---

            const calculateCurrency = () => {
                currencyResult.value = Math.round(currencyInput.value * EXCHANGE_RATE);
            };

            const formatNumber = (num) => {
                if (num === 0 || num === null || num === undefined) return '0';
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
            };

            // 取得顏色/圖示/描述
            const getCategoryColor = (category) => CATEGORY_MAP[category]?.color || CATEGORY_MAP.other.color;
            const getCategoryIcon = (category) => CATEGORY_MAP[category]?.icon || CATEGORY_MAP.other.icon;
            const getCategoryLabel = (category) => CATEGORY_LABEL_MAP[category] || '其他';
            const getWeatherIcon = (condition) => {
                const map = {
                    snow: 'fa-solid fa-snowflake',
                    sunny: 'fa-solid fa-sun',
                    cloudy: 'fa-solid fa-cloud',
                    rain: 'fa-solid fa-cloud-showers-heavy'
                };
                return map[condition] || 'fa-solid fa-cloud-question';
            };
            const getWeatherDescription = (condition) => {
                const map = {
                    snow: '大雪/降雪',
                    sunny: '晴朗',
                    cloudy: '多雲/陰天',
                    rain: '降雨'
                };
                return map[condition] || '天氣資訊未定';
            };
            const getTransportIcon = (type) => {
                const map = {
                    walk: 'fa-solid fa-shoe-prints',
                    car: 'fa-solid fa-car-side',
                    bus: 'fa-solid fa-bus-simple',
                    public: 'fa-solid fa-train-subway',
                    flight: 'fa-solid fa-plane',
                    other: 'fa-solid fa-solid fa-arrow-right-long'
                };
                return map[type] || 'fa-solid fa-arrow-right-long';
            };

            // 地圖功能
            const openMap = (query) => {
                if (query) {
                    // 使用 Google Maps 搜尋或導航
                    const url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(query)}`;
                    window.open(url, '_blank');
                }
            };

            const openMapDirections = (startItem, endItem) => {
                const origin = startItem.address || startItem.name;
                const destination = endItem.address || endItem.name;
                
                if (origin && destination) {
                    const url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(origin)}&destination=${encodeURIComponent(destination)}&travelmode=${endItem.transportType === 'car' ? 'driving' : 'transit'}`;
                    window.open(url, '_blank');
                } else {
                    alert('移動兩點間至少需要一個地點名稱或地址。');
                }
            };
            
            // 浮動按鈕點擊處理
            const handleAddClick = () => {
                if (currentTab.value === 'itinerary') {
                    resetItineraryForm();
                    showItineraryModal.value = true;
                } else if (currentTab.value === 'shopping') {
                    resetShoppingForm();
                    showShoppingModal.value = true;
                } else if (currentTab.value === 'expenses') {
                    resetExpenseForm();
                    showExpenseModal.value = true;
                }
            };
            
            // --- 行程管理 ---
            const resetItineraryForm = () => {
                isEditMode.value = false;
                newItinerary.value = {
                    id: Date.now(), name: '', category: 'sightseeing', startTime: '', hours: '', address: '', price: '', note: '', transportType: 'car', travelTime: '', isNoteExpanded: false
                };
            };

            const editItem = (item) => {
                isEditMode.value = true;
                // 深拷貝，防止直接修改原始資料
                newItinerary.value = JSON.parse(JSON.stringify(item)); 
                showItineraryModal.value = true;
            };

            const saveItineraryItem = () => {
                if (!newItinerary.value.name) {
                    alert('行程名稱不能為空');
                    return;
                }
                
                if (isEditMode.value) {
                    // 編輯模式：替換舊項目
                    const index = currentItinerary.value.findIndex(item => item.id === newItinerary.value.id);
                    if (index !== -1) {
                        currentItinerary.value[index] = { ...newItinerary.value };
                    }
                } else {
                    // 新增模式：推入新項目
                    const newItem = { ...newItinerary.value };
                    // 確保 ID 是最新的
                    newItem.id = Date.now();
                    itineraryData.value[selectedDateIndex.value].push(newItem);
                }
                
                // 重新賦值以確保 Vue 響應式更新
                itineraryData.value[selectedDateIndex.value] = [...currentItinerary.value];
                
                showItineraryModal.value = false;
                isEditMode.value = false;
            };
            
            // 刪除行程項目功能
            const removeItineraryItem = (id) => {
                if (confirm('確定要刪除這個行程嗎？此操作無法復原。')) {
                    const currentList = itineraryData.value[selectedDateIndex.value];
                    const index = currentList.findIndex(item => item.id === id);
                    
                    if (index !== -1) {
                        currentList.splice(index, 1);
                        // 重新賦值以確保 Vue 響應式更新
                        itineraryData.value[selectedDateIndex.value] = [...currentList];
                        showItineraryModal.value = false;
                        isEditMode.value = false;
                        alert('行程已刪除。');
                    }
                }
            };
            
            // 行程上下移動
            const moveItinerary = (id, direction) => {
                const currentList = currentItinerary.value;
                const index = currentList.findIndex(item => item.id === id);

                if (index === -1) return;

                const newIndex = index + direction;
                if (newIndex >= 0 && newIndex < currentList.length) {
                    // 執行交換
                    const item = currentList.splice(index, 1)[0];
                    currentList.splice(newIndex, 0, item);
                    // 重新賦值以確保 Vue 響應式更新
                    itineraryData.value[selectedDateIndex.value] = [...currentList];
                }
            };

            const moveItineraryUp = (id) => moveItinerary(id, -1);
            const moveItineraryDown = (id) => moveItinerary(id, 1);


            // --- 購物清單管理 ---
            const resetShoppingForm = () => {
                newShoppingItem.value = { name: '', image: null };
            };
            
            const handleImageUpload = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        newShoppingItem.value.image = e.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            };

            const addShoppingItem = () => {
                if (newShoppingItem.value.name.trim() === '') {
                    alert('商品名稱不能為空！');
                    return;
                }
                shoppingList.value.push({ ...newShoppingItem.value });
                showShoppingModal.value = false;
                resetShoppingForm();
            };

            const removeShoppingItem = (index) => {
                shoppingList.value.splice(index, 1);
            };

            // --- 花費管理 ---
            const resetExpenseForm = () => {
                newExpense.value = { name: '', amount: null, category: 'food', date: new Date().toISOString().substring(0, 10), payment: 'cash' };
            };

            const addExpense = () => {
                if (newExpense.value.name.trim() === '' || newExpense.value.amount === null || newExpense.value.amount <= 0) {
                    alert('請輸入有效名稱和金額！');
                    return;
                }
                expenses.value.push({ ...newExpense.value });
                // 排序 (最新到最舊)
                expenses.value.sort((a, b) => new Date(b.date) - new Date(a.date)); 
                showExpenseModal.value = false;
                resetExpenseForm();
            };

            const removeExpense = (index) => {
                expenses.value.splice(index, 1);
            };


            // 載入時執行
            onMounted(() => {
                calculateCurrency();
                // 初始載入時將 expense 排序 (最新到最舊)
                expenses.value.sort((a, b) => new Date(b.date) - new Date(a.date));
            });

            return {
                currentTab, dates, selectedDateIndex, itineraryData, currentItinerary,
                hotels, shoppingList, expenses, totalExpensesJPY, totalExpensesTWD,
                weatherData, currencyInput, currencyResult, calculateCurrency,
                getCategoryColor, getCategoryIcon, getCategoryLabel, getWeatherIcon, getTransportIcon, getWeatherDescription,
                showShoppingModal, showExpenseModal, showItineraryModal, isEditMode,
                newShoppingItem, newExpense, newItinerary,
                handleAddClick, handleImageUpload, addShoppingItem, removeShoppingItem,
                addExpense, removeExpense, editItem, saveItineraryItem,
                removeItineraryItem, 
                moveItineraryUp, moveItineraryDown, 
                openMap, openMapDirections, formatNumber
            };
        }
    }).mount('#app');
</script>
</body>
</html>

